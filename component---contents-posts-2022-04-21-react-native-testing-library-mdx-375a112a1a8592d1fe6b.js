"use strict";(self.webpackChunknew_gatsby_blog=self.webpackChunknew_gatsby_blog||[]).push([[2671],{68:function(e,n,t){t.r(n);var a=t(1151),r=t(7294);function l(e){const n=Object.assign({ul:"ul",li:"li",h2:"h2",p:"p",a:"a",h3:"h3",ol:"ol",pre:"pre",code:"code",span:"span"},(0,a.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(n.ul,null,"\n",r.createElement(n.li,null,"목차"),"\n"),"\n",r.createElement(n.h2,null,"배경"),"\n",r.createElement(n.p,null,"회사에서 오래 된 다른 라이브러리를 새로운 버전으로 마이그레이션하면서 전체 컴포넌트를 수정할 일이 있었다. 다행히도 이전에 쓰인 테스트 코드가 있었다. 하지만 일부 테스트 코드는 작동하지 않았고 작성자의 의도와는 달리 항상 통과되는 테스트들도 있었다. 특히 비동기 작업이 포함된 테스트의 경우 테스트할 방법이 없었다. 그래서 얕게 생각해서 react-testing-library 대신 enzyme을 도입하면 해결되는 게 아닐까? 잠깐 생각했지만 분명 공식 문서에는 비동기 작업도 지원하다고 되어 있었다. 무엇이 잘못일까 확인해 보았더니 library 버전이 상당히 오래 된 것을 발견했다. 그래서 ",r.createElement(n.a,{href:"https://callstack.github.io/react-native-testing-library/docs/migration-v7/"},"library를 최신화"),"하고 테스트 코드를 일부 개선했다. 덕분에 이런저런 핑걔로 테스트 코드를 거칠게 작성하고 넘어가던 습관을 바로잡고자 지금 사용하는 react-testing-library를 차근차근 공부해보기로 마음 먹었다."),"\n",r.createElement(n.h2,null,"react-native-testing-library란?"),"\n",r.createElement(n.p,null,"react-native-testing-library 는 react-testing-library에서 영감을 받은 테스트 라이브러리다. React Native는 브라우저에서 실행되지 않기 때문에 핵심 쿼리들은 다른 DOM Testing Library와 다르게 독자적으로 구현되어 있다. ",r.createElement(n.a,{href:"https://www.callstack.com/open-source?utm_source=testing-library.com&utm_medium=referral&utm_campaign=react-native-testing-library"},"Callstack"),"이라는 회사에서 개발하고 있다."),"\n",r.createElement(n.p,null,r.createElement(n.a,{href:"https://testing-library.com/docs/react-native-testing-library/intro"},"공식 문서")),"\n",r.createElement(n.h3,null,"좋은 점"),"\n",r.createElement(n.ol,null,"\n",r.createElement(n.li,null,"react-testing-library와 유사해서 금방 사용할 수 있다."),"\n",r.createElement(n.li,null,"다른 @testing-library 들과 함께 maintainer와 커뮤니티에 의해 잘 관리되고 있다."),"\n"),"\n",r.createElement(n.h2,null,"설치"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"npm install --save-dev @testing-library/react-native\nyarn add --dev @testing-library/react-native\n")),"\n",r.createElement(n.p,null,r.createElement(n.a,{href:"https://testing-library.com/docs/react-native-testing-library/setup"},"설치 가이드")),"\n",r.createElement(n.p,null,"혹시 jest가 설치가 안되어 있으신 분들은 다른 라이브러리도 설치가 필요하다."),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"npm install --save-dev jest @testing-library/jest-native @babel/preset-typescript\nyarn add --dev jest @testing-library/jest-native @babel/preset-typescript\n")),"\n",r.createElement(n.h3,null,"jest.config.js 설정"),"\n",r.createElement(n.pre,null,r.createElement(n.code,null,"const transformWhitelist = [\n    'react-native',\n    '@react-native',\n    '@react-navigation',\n];\n\nconst transformIgnorePatternsRegx = `node_modules/(?!${transformWhitelist.join('|')})`;\n\nconst config = {\n    verbose: true,\n    preset: \"@testing-library/react-native\",\n    transformIgnorePatterns: [transformIgnorePatternsRegx],\n    setupFiles: ['<rootDir>/tests/setup.ts'],\n};\n\nmodule.exports = config;\n")),"\n",r.createElement(n.h3,null,"test 파일 작성"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-jsx"},"// 예시)\nimport { render } from '@testing-library/react-native';\nimport React from 'react';\nimport Header from '../../src/components/Header';\nimport CalendarScreen from '../../src/screens/CalendarScreen';\n\ndescribe('CalendarScreen', () => {\n  describe('render components', () => {\n    it(`render header`, () => {\n      const { getByText } = render(<Header />);\n      getByText('앱이름');\n    });\n  });\n});\n")),"\n",r.createElement(n.p,null,"예시로 만든 어플리케이션에서 헤더 컴포넌트에서 ",r.createElement(n.code,null,"앱이름")," 텍스트가 잘 표시되는 지 확인하는 테스트 코드다."),"\n",r.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 337px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/4d7b7baa074818bcaa4ecdc51a32968b/f6b51/test1.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 26.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHUlEQVR42m3QyXKCUBCFYV8lTjhEQUARFEQsY2RQUAMOsTRl1sk+a98jj/rnhsRFqrL4untx+1TXLfTf1pgfKfoloqUNaRsO7a6N3HfQbA/N8nC9kNE4wJsscFxfzCHm4AFrOMuZ1hSt61Kt6RRG1yPx5zv+9ZUg2xE+75mnGf5uixUEOH7EU3oSzqTbF1brI2l2JghTFvGOODkQLXfYozkVSaNQq+hM3Ihsc2K/vzCbrViKh0m8p2d4VCWdYkmhWFa4K8mUKqrQoVzVBPWXll9Xa/REYLOHJIbxNGIebeiL86ePCUGUkqwPtJUBcsdGUe2815sGjXvjT7/5CRTlW6Wp02ibdFSHljzI6b2xCBmi6q4wyv9Jqne57fznCwuAq1QeJVrwAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="img"\n        title=""\n        src="/static/4d7b7baa074818bcaa4ecdc51a32968b/f6b51/test1.png"\n        srcset="/static/4d7b7baa074818bcaa4ecdc51a32968b/772e8/test1.png 200w,\n/static/4d7b7baa074818bcaa4ecdc51a32968b/f6b51/test1.png 337w"\n        sizes="(max-width: 337px) 100vw, 337px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",r.createElement(n.p,null,"무사히 테스트가 통과하는 것을 확인할 수 있다."),"\n",r.createElement(n.h3,null,"테스트 실행"),"\n",r.createElement(n.pre,null,r.createElement(n.code,{className:"language-bash"},"yarn test\n")),"\n",r.createElement(n.h2,null,"앞으로 할 일"),"\n",r.createElement(n.p,null,"다음 시간에는 테스트 코드를 더 많이 작성하고, 실제로 버튼을 눌러보는 액션, 비동키 코드에 대한 테스트를 해보려고 한다."))}n.default=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?r.createElement(n,e,r.createElement(l,e)):l(e)}},1151:function(e,n,t){t.d(n,{Zo:function(){return c},ah:function(){return l}});var a=t(7294);const r=a.createContext({});function l(e){const n=a.useContext(r);return a.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const s={};function c({components:e,children:n,disableParentContext:t}){let c;return c=t?"function"==typeof e?e({}):e||s:l(e),a.createElement(r.Provider,{value:c},n)}}}]);
//# sourceMappingURL=component---contents-posts-2022-04-21-react-native-testing-library-mdx-375a112a1a8592d1fe6b.js.map